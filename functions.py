# -*- coding: utf-8 -*-"""Created on Mon Jan 30 19:50:15 2023@author: Tania"""# python3 -m venv venv/ import pandas as pdimport pathlibimport globfrom os import listdirfrom os.path import isfile, joinimport numpy as npimport pandas_datareader.data as webfrom scipy.optimize import minimizeimport yfinance as yfmsft = yf.Ticker("MSFT")def import_files(path):    files = list(glob.glob(path))    all_files = {}    for i in files:        data = pd.read_csv(i, skiprows=2).iloc[:-1 , :]        all_files[i[14:22]] = data[['Ticker', 'Peso (%)']]    for i in range(0, len(all_files.keys())):        all_files[list(all_files.keys())[i]]=all_files[list(all_files.keys())[i]].sort_values('Ticker')    return all_filesdef find_tickers(datos,columna):    for i in range(0,len(datos.keys())-1):        if i==0:            common_tickers = datos[list(datos.keys())[i]][columna]        else:            common_tickers = set(common_tickers).intersection(set(datos[list(datos.keys())[i+1]][columna].values))            datos[list(datos.keys())[i]] = datos[list(datos.keys())[i]].drop(datos[list(datos.keys())[i]].index[~datos[list(datos.keys())[i]][columna].isin(common_tickers)])        #print(common_tickers)    for i in range(0,len(datos.keys())):        datos[list(datos.keys())[i]][columna]=datos[list(datos.keys())[i]][columna].str.replace("*", "").str.replace(".", "-")    for i in range(0, len(datos.keys())):        datos[list(datos.keys())[i]][columna]=datos[list(datos.keys())[i]][columna].map('{}.MX'.format)    return common_tickers, datos